<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Class 11: Programming in R (part 2)</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-12-05"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-12-05"/>
  <meta name="article:author" content="Ryan Sheridan and Kent Riemondy"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Class 11: Programming in R (part 2)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Class 11: Programming in R (part 2)"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","date","output","draft"]}},"value":[{"type":"character","attributes":{},"value":["Class 11: Programming in R (part 2)"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Ryan Sheridan and Kent Riemondy"]}]}]},{"type":"character","attributes":{},"value":["2022-12-05"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"logical","attributes":{},"value":[true]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/brauer_gene_exp.csv.gz","data/yeast_prot_prop.csv.gz","programming-in-r-pt2_files/anchor-4.2.2/anchor.min.js","programming-in-r-pt2_files/bowser-1.9.3/bowser.min.js","programming-in-r-pt2_files/distill-2.2.21/template.v2.js","programming-in-r-pt2_files/figure-html5/unnamed-chunk-13-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-14-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-16-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-17-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-21-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-23-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-24-1.png","programming-in-r-pt2_files/figure-html5/unnamed-chunk-8-1.png","programming-in-r-pt2_files/header-attrs-2.14/header-attrs.js","programming-in-r-pt2_files/jquery-3.6.0/jquery-3.6.0.js","programming-in-r-pt2_files/jquery-3.6.0/jquery-3.6.0.min.js","programming-in-r-pt2_files/jquery-3.6.0/jquery-3.6.0.min.map","programming-in-r-pt2_files/popper-2.6.0/popper.min.js","programming-in-r-pt2_files/tippy-6.2.7/tippy-bundle.umd.min.js","programming-in-r-pt2_files/tippy-6.2.7/tippy-light-border.css","programming-in-r-pt2_files/tippy-6.2.7/tippy.css","programming-in-r-pt2_files/tippy-6.2.7/tippy.umd.min.js","programming-in-r-pt2_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="programming-in-r-pt2_files/header-attrs-2.14/header-attrs.js"></script>
  <script src="programming-in-r-pt2_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="programming-in-r-pt2_files/popper-2.6.0/popper.min.js"></script>
  <link href="programming-in-r-pt2_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="programming-in-r-pt2_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="programming-in-r-pt2_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="programming-in-r-pt2_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="programming-in-r-pt2_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="programming-in-r-pt2_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="programming-in-r-pt2_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Class 11: Programming in R (part 2)","authors":[{"author":"Ryan Sheridan and Kent Riemondy","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-12-05T00:00:00.000-07:00","citationText":"Riemondy, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Class 11: Programming in R (part 2)</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Ryan Sheridan and Kent Riemondy  
  
<br/>2022-12-05
</div>

<div class="d-article">
<p><em>The Rmarkdown for this class is <a href="https://github.com/rnabioco/bmsc-7810-pbda/blob/main/_posts/2022-12-05-class-11-programming-in-r-part-2/programming-in-r-pt2.Rmd">on github</a></em></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># conditionally download all of the files used in rmarkdown from github </span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='st'>"https://github.com/rnabioco/bmsc-7810-pbda/raw/main/_posts/2022-12-05-class-10-programming-in-r-part-1/download-files.R"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><br></p>
<h2 id="introduction">Introduction</h2>
<p>As discussed in the previous class, you should try to limit duplication in your code. One way to do this is by writing functions, another way is through iteration. Reducing code duplication has several benefits:</p>
<ul>
<li>Your code easier to read</li>
<li>You reduce the chance of mistakes from repeated copying and pasting</li>
<li>It is easier to adapt your code for different requirements</li>
</ul>
<p>Further reading</p>
<ul>
<li><a href="https://r4ds.had.co.nz">R for Data Science</a> by Garrett Grolemund and Hadley Wickham</li>
<li><a href="https://adv-r.hadley.nz">Advanced R</a> by Hadley Wickham</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><br></p>
<p><br></p>
<h2 id="for-loops"><code>for</code> loops</h2>
<p><code>for</code> loops allow you to run the same code block repeatedly without copying and pasting.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># When writing a for loop, think about the output, sequence, and body</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"numeric"</span>, <span class='fl'>5</span><span class='op'>)</span>  <span class='co'># output</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>   <span class='co'># sequence</span></span>
<span>  </span>
<span>  <span class='va'>out</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span> <span class='op'>*</span> <span class='fl'>5</span>            <span class='co'># body</span></span>
<span>  </span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># It's helpful to think about what happens during each cycle of the loop</span></span>
<span><span class='va'>out</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>*</span> <span class='fl'>5</span>  <span class='co'># i = 1</span></span>
<span><span class='va'>out</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>5</span>  <span class='co'># i = 2</span></span>
<span><span class='va'>out</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fl'>5</span>  <span class='co'># i = 3</span></span>
<span><span class='va'>out</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>4</span> <span class='op'>*</span> <span class='fl'>5</span>  <span class='co'># i = 4</span></span>
<span><span class='va'>out</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>5</span> <span class='op'>*</span> <span class='fl'>5</span>  <span class='co'># i = 5</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Lets use rnorm() to create 5 vectors with different values for 'mean'</span></span>
<span><span class='co'># One way to do this is by copying and pasting</span></span>
<span><span class='va'>vec_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span>, <span class='fl'>20</span>, <span class='fl'>5</span>, <span class='fl'>70</span><span class='op'>)</span>                <span class='co'># input</span></span>
<span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vec_in</span><span class='op'>)</span><span class='op'>)</span>        <span class='co'># output</span></span>
<span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>    </span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Use a for loop to reduce code duplication</span></span>
<span><span class='va'>vec_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span>, <span class='fl'>20</span>, <span class='fl'>5</span>, <span class='fl'>70</span><span class='op'>)</span>                  <span class='co'># input</span></span>
<span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vec_in</span><span class='op'>)</span><span class='op'>)</span>          <span class='co'># output</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vec_in</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>                  <span class='co'># sequence</span></span>
<span>  </span>
<span>  <span class='va'>out</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>  <span class='co'># body</span></span>
<span>  </span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p><br></p>
<p><em>Write a <code>for</code> loop to create 3 vectors of different lengths</em></p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>#&gt; [[1]]
#&gt; [1] -0.1341215  1.2764627 -1.2881541 -1.3291300 -0.6715333
#&gt; 
#&gt; [[2]]
#&gt;  [1] -0.56392372  0.62893785 -0.08986873  2.77081510 -0.46334036
#&gt;  [6] -0.91977187  0.54046416  0.75400347  0.62740813  1.36544574
#&gt; 
#&gt; [[3]]
#&gt; [1] 0.5409006 0.4868347</code></pre>
</div>
<p><br></p>
<p>Using <code>seq_along(x)</code> instead of <code>1:length(x)</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># seq_along() mimics 1:length() for non-empty vectors</span></span>
<span><span class='va'>vec_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vec_in</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; [1] 1 2 3</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>vec_in</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; [1] 1 2 3</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span></span>
<span><span class='co'># seq_along() correctly handles empty vectors</span></span>
<span><span class='va'>emp_vec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"numeric"</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span></span>
<span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>emp_vec</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; [1] 1 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>emp_vec</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; integer(0)</code></pre>
</div>
<p><br></p>
<p><br></p>
<h2 id="using-the-brauer-data">Using the Brauer data</h2>
<p>Using the Brauer gene expression data lets create a figure showing the growth rate vs expression for four genes</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>brauer_gene_exp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"data/brauer_gene_exp.csv.gz"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># This is the function we wrote in class-6</span></span>
<span><span class='va'>plot_expr</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span>, <span class='va'>sys_name</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  </span>
<span>  <span class='va'>gg_data</span> <span class='op'>&lt;-</span> <span class='va'>input</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>systematic_name</span> <span class='op'>==</span> <span class='va'>sys_name</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>plot_title</span> <span class='op'>&lt;-</span> <span class='va'>gg_data</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  <span class='va'>plot_sub</span> <span class='op'>&lt;-</span> <span class='va'>gg_data</span><span class='op'>$</span><span class='va'>MF</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  </span>
<span>  <span class='va'>gg_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>rate</span>, <span class='va'>expression</span>, color <span class='op'>=</span> <span class='va'>nutrient</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='va'>plot_title</span>, subtitle <span class='op'>=</span> <span class='va'>plot_sub</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>nutrient</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Lets try this with the copy-and-paste method</span></span>
<span><span class='va'>vec_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"YDL104C"</span>, <span class='st'>"YLR115W"</span>, <span class='st'>"YMR183C"</span>, <span class='st'>"YML017W"</span><span class='op'>)</span>       <span class='co'># input</span></span>
<span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vec_in</span><span class='op'>)</span><span class='op'>)</span>                         <span class='co'># output </span></span>
<span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>plot_expr</span><span class='op'>(</span><span class='va'>brauer_gene_exp</span>, sys_name <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>  </span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>plot_expr</span><span class='op'>(</span><span class='va'>brauer_gene_exp</span>, sys_name <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>plot_expr</span><span class='op'>(</span><span class='va'>brauer_gene_exp</span>, sys_name <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>out</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>plot_expr</span><span class='op'>(</span><span class='va'>brauer_gene_exp</span>, sys_name <span class='op'>=</span> <span class='va'>vec_in</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_plots.html'>wrap_plots</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="programming-in-r-pt2_files/figure-html5/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p><br></p>
<p><em>Re-write the code from above using a <code>for</code> loop to generate our figure</em></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>vec_in <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;YDL104C&quot;</span>, <span class="st">&quot;YLR115W&quot;</span>, <span class="st">&quot;YMR183C&quot;</span>, <span class="st">&quot;YML017W&quot;</span>)  <span class="co"># input</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(vec_in))                    <span class="co"># output</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( ???? ) {                                           <span class="co"># sequence</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                                                         <span class="co"># body</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(out)</span></code></pre></div>
</div>
<p><br></p>
<p><br></p>
<h2 id="a-note-on-vectorization">A note on vectorization</h2>
<p><em>In general you should try to use a vectorized function/approach before using iteration.</em> Vectorized approaches will be faster and require less code to run. If you are working with a vector or matrix, then there is likely a vectorized operation that can be used.</p>
<p>There are however a few common places that iteration is used:<br />
- To process multiple datasets/data.frames. (e.g.apply a function to a list of data.frames)<br />
- plotting (e.g.make multiple plots with a varying parameter or aesthetic)<br />
- perform a custom operation that does not have a vectorized approach</p>
<h2 id="introduction-to-the-apply-familar-of-functions.">Introduction to the <code>apply</code> familar of functions.</h2>
<p><code>for</code> loops are a powerful tool to reduce code duplication, however your code can be simplified using the <code>lapply</code> function and related apply functions in base R. These functions essentially run <code>for (i in seq_along(x))</code> behind the scenes so you dont have to explicitly type this.</p>
<p>There is a function for each type of output:</p>
<ul>
<li><code>lapply()</code> iterate over a vector, applying a function, returning a list</li>
<li><code>sapply()</code> iterate over a vector, applying a function, coercing the output to a vector</li>
<li><code>apply()</code> iterate over a row, column, or all elements of a matrix</li>
<li><code>mapply()</code> iterate over each element of multiple supplied vectors</li>
</ul>
<p>The lapply function requires two inputs: <code>lapply(X, FUN, ...)</code></p>
<ul>
<li><code>X</code> is a list or atomic vector</li>
<li><code>FUN</code> is a function</li>
<li> additional arguments to FUN</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># We previously used a for loop to create vectors with different values for mean</span></span>
<span><span class='va'>vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span>, <span class='fl'>20</span>, <span class='fl'>5</span>, <span class='fl'>70</span><span class='op'>)</span>                  <span class='co'># input</span></span>
<span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vals</span><span class='op'>)</span><span class='op'>)</span>          <span class='co'># output</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>vals</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>                 <span class='co'># sequence</span></span>
<span>  </span>
<span>  <span class='va'>out</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>vals</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>  <span class='co'># body</span></span>
<span>  </span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Using lapply() we can further simplify this code</span></span>
<span><span class='co'># x indicates where each element of the vector should be inserted</span></span>
<span><span class='co'># this is an example of an anonymous function</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># similarly we can define the function first</span></span>
<span><span class='va'>rnorm_custom</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='va'>rnorm_custom</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># You can use brackets to include a multi-line code block</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Each element of the vector is passed to the first available argument</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='va'>rnorm</span>, n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><br></p>
<p><em>Use <code>rnorm()</code> and <code>lapply()</code> to create 3 vectors of different lengths</em></p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>#&gt; [[1]]
#&gt; [1] -0.6647936 -0.9514304  1.8890677  0.3299700 -0.4689970
#&gt; 
#&gt; [[2]]
#&gt;  [1] -0.7785255 -1.2655668 -0.7856040 -0.2030935  1.1013461 -0.2324108
#&gt;  [7]  0.3022877 -2.0794848 -0.0551362  1.1514868
#&gt; 
#&gt; [[3]]
#&gt; [1] -0.5590626  1.3403762</code></pre>
</div>
<p><br></p>
<em>Re-write the code from above using <code>lapply()</code> to generate our growth rate figure</em>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;YDL104C&quot;</span>, <span class="st">&quot;YOR069W&quot;</span>, <span class="st">&quot;YLR115W&quot;</span>, <span class="st">&quot;YPR036W&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>expr_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  ????</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(expr_plots)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="programming-in-r-pt2_files/figure-html5/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p><br></p>
<p><br></p>
<p>Note that we can iterate over lists in addition to vectors. A common operation might be to read in multiple files and perform some operation</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># get paths to files in "data" directory</span></span>
<span><span class='va'>file_names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span><span class='op'>(</span><span class='st'>"data"</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># read each file into R and store in a list</span></span>
<span><span class='va'>lst_of_dfs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>file_names</span>, <span class='va'>read_csv</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># get nrow of each file</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>lst_of_dfs</span>, <span class='va'>nrow</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># select 5 random rows</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>lst_of_dfs</span>, <span class='va'>slice_sample</span>, n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># check is any NAs are present</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>lst_of_dfs</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Note that a <code>data.frame</code> is a list of columns in R (e.g.see output of <code>typeof(mtcars)</code>). So if we use <code>lapply()</code> on a data.frame it will iterate over each column.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>mtcars</span>, <span class='va'>mean</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; $mpg
#&gt; [1] 20.09062
#&gt; 
#&gt; $cyl
#&gt; [1] 6.1875
#&gt; 
#&gt; $disp
#&gt; [1] 230.7219
#&gt; 
#&gt; $hp
#&gt; [1] 146.6875
#&gt; 
#&gt; $drat
#&gt; [1] 3.596563
#&gt; 
#&gt; $wt
#&gt; [1] 3.21725
#&gt; 
#&gt; $qsec
#&gt; [1] 17.84875
#&gt; 
#&gt; $vs
#&gt; [1] 0.4375
#&gt; 
#&gt; $am
#&gt; [1] 0.40625
#&gt; 
#&gt; $gear
#&gt; [1] 3.6875
#&gt; 
#&gt; $carb
#&gt; [1] 2.8125</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>mtcars</span>, <span class='va'>class</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt; $mpg
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $cyl
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $disp
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $hp
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $drat
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $wt
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $qsec
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $vs
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $am
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $gear
#&gt; [1] &quot;numeric&quot;
#&gt; 
#&gt; $carb
#&gt; [1] &quot;numeric&quot;</code></pre>
</div>
<p><code>sapply()</code> will coerce the output to be a vector rather than a list.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>mtcars</span>, <span class='va'>mean</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt;        mpg        cyl       disp         hp       drat         wt 
#&gt;  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250 
#&gt;       qsec         vs         am       gear       carb 
#&gt;  17.848750   0.437500   0.406250   3.687500   2.812500</code></pre>
</div>
<h2 id="iterating-over-matrices">iterating over matrices</h2>
<p>The <code>apply()</code> function allows you to iterates over a row, column, or all elements of a matrix.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>              nrow <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>              dimnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"row_"</span>, <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                              <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"column_"</span>, <span class='va'>letters</span><span class='op'>[</span><span class='fl'>11</span><span class='op'>:</span><span class='fl'>20</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>mat</span></span></code></pre>
</div>
<pre><code>#&gt;          column_k   column_l    column_m    column_n   column_o
#&gt; row_a -1.06708863 -1.5022194 -0.08974643 -0.32425948  0.8033288
#&gt; row_b -0.52666459 -1.3577169 -0.08638919  3.17136005  0.7996905
#&gt; row_c -1.55101625 -1.7504154  0.22424491  0.49754364 -1.8788369
#&gt; row_d  1.00434518  0.9702484  1.25610317 -1.10706685 -0.8080885
#&gt; row_e -0.04399672 -0.3252531 -0.37106115  0.76826040 -1.2753276
#&gt; row_f -0.82719769  0.9403499  0.71587276 -0.72197242  1.3678902
#&gt; row_g  0.08664878  0.4707904  0.86410922  0.02240988 -0.9136320
#&gt; row_h -0.58428901 -0.9392183  0.95301778  0.68284039 -0.8595566
#&gt; row_i -0.78445077  1.3778725 -0.06642688 -0.27281017 -0.3138951
#&gt; row_j  0.46792627  2.2607923 -1.16763680  0.19221097 -0.2363515
#&gt;         column_p   column_q    column_r    column_s    column_t
#&gt; row_a -2.2412455  0.3251078  0.37705228 -0.63961545 -0.59243264
#&gt; row_b  0.2598410 -0.3985272  2.98338381  0.22194880 -0.97107253
#&gt; row_c  0.7699561 -0.6795639  0.47893791 -0.03725524  0.32501512
#&gt; row_d  1.5592128  1.9372044 -0.76975875  0.75756237 -0.92240478
#&gt; row_e -0.4236237  0.8654730 -0.40846573 -0.02938995 -0.90146802
#&gt; row_f -2.2324876 -0.1163883 -1.29956546 -0.07396488 -0.35394751
#&gt; row_g  0.2676766  1.3098976  0.26408292 -0.28427773  1.41557028
#&gt; row_h -1.4648848 -1.0343980 -1.38747408 -0.22289661  0.06293687
#&gt; row_i  0.3705403 -1.8943217 -0.08938199  0.07590986 -1.11937175
#&gt; row_j  0.9891316 -2.8293129  0.15581106 -0.25206743  0.27256698</code></pre>
</div>
<p>The arguments are:<br />
<code>apply(X, MARGIN, FUN, ...)</code></p>
<p>X = matrix<br />
MARGIN = specify how to iterate (1 = by row, 2 = by column, c(1,2) = all values)<br />
FUN = function to apply</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># get max value in each row</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>mat</span>, <span class='fl'>1</span>, <span class='va'>max</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># get max value in each column</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>mat</span>, <span class='fl'>2</span>, <span class='va'>max</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># multiply each value by 1e6</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>mat</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span> <span class='op'>*</span> <span class='fl'>1e6</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><strong>Note that many operations on matrices are vectorized already and you often dont need to use
apply</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># e.g.compare to above, multiply each value by 1e6</span></span>
<span><span class='va'>mat</span> <span class='op'>*</span> <span class='fl'>1e6</span></span></code></pre>
</div>
</div>
<p>Use the <code>matrixStats</code> package for common row-wise or column-wise operations before using apply.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># in base R</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt;       row_a       row_b       row_c       row_d       row_e 
#&gt; -0.49511186  0.40958537 -0.36013901  0.38773575 -0.21448526 
#&gt;       row_f       row_g       row_h       row_i       row_j 
#&gt; -0.26014110  0.35032759 -0.47939223 -0.27163358 -0.01469294</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span></span>
<span><span class='co'># other functions in matrixStates</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/HenrikBengtsson/matrixStats'>matrixStats</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/matrixStats/man/rowRanges.html'>rowMaxs</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt;  [1] 0.8033288 3.1713600 0.7699561 1.9372044 0.8654730 1.3678902
#&gt;  [7] 1.4155703 0.9530178 1.3778725 2.2607923</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/matrixStats/man/rowRanges.html'>rowMaxs</a></span><span class='op'>(</span><span class='va'>mat</span>, useNames <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt;     row_a     row_b     row_c     row_d     row_e     row_f     row_g 
#&gt; 0.8033288 3.1713600 0.7699561 1.9372044 0.8654730 1.3678902 1.4155703 
#&gt;     row_h     row_i     row_j 
#&gt; 0.9530178 1.3778725 2.2607923</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/matrixStats/man/rowMedians.html'>colMedians</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>#&gt;  [1] -0.55547680  0.07276866  0.07890902  0.10731043 -0.56099180
#&gt;  [6]  0.26375883 -0.25745775  0.03321454 -0.05561006 -0.47319008</code></pre>
</div>
<h2 id="iterating-over-multiple-vectors">Iterating over multiple vectors</h2>
<p>If you have two vectors containing values that you want to pass to a function this can be accomplished with <code>mapply()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapply</span>(FUN, ..., <span class="at">MoreArgs =</span> <span class="cn">NULL</span>, <span class="at">SIMPLIFY =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>FUN = function<br />
 = vectors to iterate over, supplied as named arguments<br />
MoreArgs = additional arguments with are not vectors supplied as a list<br />
SIMPLIFY = whether to simplify the result</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"YDL104C"</span>, <span class='st'>"YOR069W"</span>, <span class='st'>"YLR115W"</span>, <span class='st'>"YPR036W"</span><span class='op'>)</span></span>
<span><span class='va'>shapes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>expr_plots</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='va'>plot_expr</span>, <span class='co'># function</span></span>
<span>                     sys_name <span class='op'>=</span> <span class='va'>genes</span>, </span>
<span>                     shape <span class='op'>=</span> <span class='va'>shapes</span>,</span>
<span>                     MoreArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>input <span class='op'>=</span> <span class='va'>brauer_gene_exp</span><span class='op'>)</span>,</span>
<span>                     SIMPLIFY <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_plots.html'>wrap_plots</a></span><span class='op'>(</span><span class='va'>expr_plots</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="programming-in-r-pt2_files/figure-html5/unnamed-chunk-21-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p><br></p>
<p><em>Use <code>mapply()</code> to create plots for 4 different genes, each with a different point size</em></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;YDL104C&quot;</span>, <span class="st">&quot;YOR069W&quot;</span>, <span class="st">&quot;YLR115W&quot;</span>, <span class="st">&quot;YPR036W&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>expr_plots <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  ????</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(expr_plots)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="programming-in-r-pt2_files/figure-html5/unnamed-chunk-23-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p><br></p>
<p>Alternatively you may find it more readable to use a for loop and a list to store all of the arguments.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>n_plots</span> <span class='op'>&lt;-</span> <span class='fl'>4</span></span>
<span><span class='va'>plot_args</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  sys_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"YDL104C"</span>, <span class='st'>"YOR069W"</span>, <span class='st'>"YLR115W"</span>, <span class='st'>"YPR036W"</span><span class='op'>)</span>,</span>
<span>  size     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>  shape    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># preallocate a list of length 4</span></span>
<span><span class='va'>expr_plots</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span>mode <span class='op'>=</span> <span class='st'>"list"</span>, length <span class='op'>=</span> <span class='va'>n_plots</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>n_plots</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>plot_expr</span><span class='op'>(</span>input <span class='op'>=</span> <span class='va'>brauer_gene_exp</span>,</span>
<span>            sys_name <span class='op'>=</span> <span class='va'>plot_args</span><span class='op'>$</span><span class='va'>sys_name</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>,</span>
<span>            size <span class='op'>=</span> <span class='va'>plot_args</span><span class='op'>$</span><span class='va'>size</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>,</span>
<span>            shape <span class='op'>=</span> <span class='va'>plot_args</span><span class='op'>$</span><span class='va'>shape</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span></span>
<span>  <span class='va'>expr_plots</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>p</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_plots.html'>wrap_plots</a></span><span class='op'>(</span><span class='va'>expr_plots</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="programming-in-r-pt2_files/figure-html5/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<h2 id="using-the-map-family-of-functions-from-the-purrr-package">Using the <code>map()</code> family of functions from the <code>purrr</code> package</h2>
<p>The <code>purrr</code> package from the tidyverse provides functions similar to <code>lapply</code>, which require even less code than <code>lapply</code>.</p>
<p>There is a function for each type of output:</p>
<ul>
<li><p><code>map()</code> makes a list (similar to <code>lapply()</code>)</p></li>
<li><p><code>map2()</code> iterate over two vector/lists by element (similar to <code>mapply() with 2 vectors</code>)</p></li>
<li><p><code>pmap()</code> iterate over each element of a list element-wise (similar to <code>mapply()</code>)</p></li>
<li><p><code>map_dfr()</code> iterate over a vector/list, then combine output into a data.frame using <code>bind_rows()</code></p></li>
<li><p><code>map_cfr()</code> iterate over a vector/list, then combine output into a data.frame using <code>bind_cols()</code></p></li>
<li><p><code>map_lgl()</code> iterate over a vector/list, return a logical vector (similar to vapply)</p></li>
<li><p><code>map_int()</code> iterate over a vector/list, return an integer vector</p></li>
<li><p><code>map_dbl()</code> iterate over a vector/list, return a double vector</p></li>
<li><p><code>map_chr()</code> iterate over a vector/list, return a character vector</p></li>
</ul>
<p>Each <code>map()</code> function requires two inputs: <code>map(.x, .f, ...)</code></p>
<ul>
<li><code>.x</code> is a list or atomic vector</li>
<li><code>.f</code> is a function or formula</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># We previously lapply to create vectors with different values for mean</span></span>
<span><span class='va'>vals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>50</span>, <span class='fl'>20</span>, <span class='fl'>5</span>, <span class='fl'>70</span><span class='op'>)</span>                  <span class='co'># input</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Using map() we can further simplify this code</span></span>
<span><span class='co'># .x indicates where each element of the vector should be inserted</span></span>
<span><span class='co'># the ~ is shorthand for an anonymous function e.e. function(.x)</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span>.x <span class='op'>=</span> <span class='va'>vals</span>, .f <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># You can use brackets to include a multi-line code block</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='op'>~</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, mean <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># or use syntax similar to lapply</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, <span class='va'>input</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># map() allows for very readable code</span></span>
<span><span class='co'># Each element of the vector is passed to the first available argument</span></span>
<span><span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>vals</span>, <span class='va'>rnorm</span>, n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
