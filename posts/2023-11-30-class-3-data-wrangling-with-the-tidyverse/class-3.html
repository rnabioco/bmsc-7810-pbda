<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Class 3: Data wrangling with the tidyverse</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2023-11-30"/>
  <meta property="article:created" itemprop="dateCreated" content="2023-11-30"/>
  <meta name="article:author" content="Kent Riemondy"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Class 3: Data wrangling with the tidyverse"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Class 3: Data wrangling with the tidyverse"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","output","date"]}},"value":[{"type":"character","attributes":{},"value":["Class 3: Data wrangling with the tidyverse"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Kent Riemondy"]},{"type":"character","attributes":{},"value":["https://github.com/kriemo"]},{"type":"character","attributes":{},"value":["RNA Bioscience Initiative"]},{"type":"character","attributes":{},"value":["https://medschool.cuanschutz.edu/rbi"]},{"type":"character","attributes":{},"value":["0000-0003-0750-1273"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["11-30-2023"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["class-2_files/anchor-4.2.2/anchor.min.js","class-2_files/bowser-1.9.3/bowser.min.js","class-2_files/distill-2.2.21/template.v2.js","class-2_files/header-attrs-2.14/header-attrs.js","class-2_files/jquery-3.6.0/jquery-3.6.0.js","class-2_files/jquery-3.6.0/jquery-3.6.0.min.js","class-2_files/jquery-3.6.0/jquery-3.6.0.min.map","class-2_files/popper-2.6.0/popper.min.js","class-2_files/tippy-6.2.7/tippy-bundle.umd.min.js","class-2_files/tippy-6.2.7/tippy-light-border.css","class-2_files/tippy-6.2.7/tippy.css","class-2_files/tippy-6.2.7/tippy.umd.min.js","class-2_files/webcomponents-2.0.0/webcomponents.js","class-2.html","class-3_files/anchor-4.2.2/anchor.min.js","class-3_files/bowser-1.9.3/bowser.min.js","class-3_files/distill-2.2.21/template.v2.js","class-3_files/header-attrs-2.25/header-attrs.js","class-3_files/jquery-3.6.0/jquery-3.6.0.js","class-3_files/jquery-3.6.0/jquery-3.6.0.min.js","class-3_files/jquery-3.6.0/jquery-3.6.0.min.map","class-3_files/popper-2.6.0/popper.min.js","class-3_files/tippy-6.2.7/tippy-bundle.umd.min.js","class-3_files/tippy-6.2.7/tippy-light-border.css","class-3_files/tippy-6.2.7/tippy.css","class-3_files/tippy-6.2.7/tippy.umd.min.js","class-3_files/webcomponents-2.0.0/webcomponents.js","flights14.csv","robjs.rda"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="class-3_files/header-attrs-2.25/header-attrs.js"></script>
  <script src="class-3_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="class-3_files/popper-2.6.0/popper.min.js"></script>
  <link href="class-3_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="class-3_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="class-3_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="class-3_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="class-3_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="class-3_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="class-3_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Class 3: Data wrangling with the tidyverse","authors":[{"author":"Kent Riemondy","authorURL":"https://github.com/kriemo","affiliation":"RNA Bioscience Initiative","affiliationURL":"https://medschool.cuanschutz.edu/rbi","orcidID":"0000-0003-0750-1273"}],"publishedDate":"2023-11-30T00:00:00.000-07:00","citationText":"Riemondy, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Class 3: Data wrangling with the tidyverse</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Kent Riemondy <a href="https://github.com/kriemo" class="uri">https://github.com/kriemo</a> (RNA Bioscience Initiative)<a href="https://medschool.cuanschutz.edu/rbi" class="uri">https://medschool.cuanschutz.edu/rbi</a>
  
<br/>11-30-2023
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction-to-the-tidyverse" id="toc-introduction-to-the-tidyverse">Introduction to the tidyverse</a></li>
<li><a href="#loading-r-packages" id="toc-loading-r-packages">loading R packages</a></li>
<li><a href="#tibble-versus-data.frame" id="toc-tibble-versus-data.frame">tibble versus data.frame</a></li>
<li><a href="#convertly-a-typical-data.frame-to-a-tibble" id="toc-convertly-a-typical-data.frame-to-a-tibble">Convertly a typical data.frame to a tibble</a></li>
<li><a href="#data-import-using-readr" id="toc-data-import-using-readr">Data import using readr</a></li>
<li><a href="#data-importexport-for-excel-files" id="toc-data-importexport-for-excel-files">Data import/export for excel files</a></li>
<li><a href="#data-importexport-of-r-objects" id="toc-data-importexport-of-r-objects">Data import/export of R objects</a></li>
<li><a href="#exploring-data" id="toc-exploring-data">Exploring data</a></li>
<li><a href="#grammar-for-data-manipulation-dplyr" id="toc-grammar-for-data-manipulation-dplyr">Grammar for data manipulation: dplyr</a>
<ul>
<li><a href="#base-r-versus-dplyr" id="toc-base-r-versus-dplyr">Base R versus dplyr</a></li>
<li><a href="#dplyr-function-overview" id="toc-dplyr-function-overview">dplyr function overview</a></li>
<li><a href="#filter-rows" id="toc-filter-rows">Filter rows</a></li>
<li><a href="#arrange-rows" id="toc-arrange-rows">arrange rows</a></li>
</ul></li>
<li><a href="#column-operations" id="toc-column-operations">Column operations</a>
<ul>
<li><a href="#select-columns" id="toc-select-columns">select columns</a></li>
</ul></li>
<li><a href="#when-to-quote-or-not-quote" id="toc-when-to-quote-or-not-quote">When to quote or not quote?</a></li>
<li><a href="#adding-new-columns-with-mutate" id="toc-adding-new-columns-with-mutate">Adding new columns with mutate</a></li>
<li><a href="#summarizing-columns" id="toc-summarizing-columns">Summarizing columns</a></li>
<li><a href="#grouped-operations" id="toc-grouped-operations">Grouped operations</a></li>
<li><a href="#string-manipulation" id="toc-string-manipulation">String manipulation</a></li>
<li><a href="#acknowledgements-and-additional-references" id="toc-acknowledgements-and-additional-references">Acknowledgements and additional references</a></li>
</ul>
</nav>
</div>
<p><em>The Rmarkdown for this class is <a href="https://github.com/rnabioco/bmsc-7810-pbda/blob/main/_posts/2022-10-04-class-2/class-2.Rmd">on github</a></em></p>
<h2 id="introduction-to-the-tidyverse">Introduction to the tidyverse</h2>
<p>The <a href="https://www.tidyverse.org/">tidyverse</a> is a collection of packages that share similar design philosophy, syntax, and data structures. The packages are largely developed by the same team that builds Rstudio.</p>
<p>Some key packages that we will touch on in this course:</p>
<p><code>readr</code>: functions for data import and export<br />
<code>ggplot2</code>: plotting based on the “grammar of graphics”<br />
<code>dplyr</code>: functions to manipulate tabular data<br />
<code>tidyr</code>: functions to help reshape data into a tidy format<br />
<code>stringr</code>: functions for working with strings<br />
<code>tibble</code>: a redesigned data.frame</p>
<h2 id="loading-r-packages">loading R packages</h2>
<p>To use an R package in an analysis we need to load the package using the <code>library()</code> function. This needs to be done once in each R session and it is a good idea to do this at the beginning of your Rmarkdown. For teaching purposes I will however sometimes load a package when I introduce a function from a package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readr.tidyverse.org'>readr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tibble.tidyverse.org/'>tibble</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="tibble-versus-data.frame">tibble versus data.frame</h2>
<p>A <code>tibble</code> is a re-imagining of the base R <code>data.frame</code>. It has a few differences from the <code>data.frame</code>.The biggest differences are that it doesn’t have <code>row.names</code> and it has an enhanced <code>print</code> method. If interested in learning more, see the tibble <a href="https://tibble.tidyverse.org/articles/tibble.html">vignette</a>.</p>
<p>Compare <code>data</code> to <code>data_tbl</code>.</p>
<p><strong>Note, by default Rstudio displays base R data.frames in a tibble-like format</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, </span>
<span>                   b <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, </span>
<span>                   c <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, </span>
<span>                   row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span>, <span class='st'>"c"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>data_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span></span>
<span><span class='va'>data_tbl</span></span></code></pre>
</div>
</div>
<p>When you work with tidyverse functions it is a good practice to convert data.frames to tibbles.</p>
<h2 id="convertly-a-typical-data.frame-to-a-tibble">Convertly a typical data.frame to a tibble</h2>
<p>If a data.frame has rownames, you can preserve these by moving them into a column before converting to a tibble using the <code>rownames_to_column()</code> from <code>tibble</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>mtcars</span> <span class='op'>)</span></span></code></pre>
</div>
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mtcars_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames_to_column</a></span><span class='op'>(</span><span class='va'>mtcars</span>, <span class='st'>"vehicle"</span><span class='op'>)</span></span>
<span><span class='va'>mtcars_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>mtcars_tbl</span><span class='op'>)</span></span>
<span><span class='va'>mtcars_tbl</span></span></code></pre>
</div>
<pre><code># A tibble: 32 × 12
   vehicle       mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 …  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D…  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo…  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows</code></pre>
</div>
<p>If you don’t need the rownames, then you can use the <code>as_tibble()</code> function directly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mtcars_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="data-import-using-readr">Data import using readr</h2>
<p>The <a href="https://readr.tidyverse.org/"><code>readr</code></a> package provides a series of functions for importing or writing data in common text formats.</p>
<p><code>read_csv()</code>: comma-separated values (CSV) files<br />
<code>read_tsv()</code>: tab-separated values (TSV) files<br />
<code>read_delim()</code>: delimited files (CSV and TSV are important special cases)<br />
<code>read_fwf()</code>: fixed-width files<br />
<code>read_table()</code>: whitespace-separated files</p>
<p>These functions are faster and have better defaults than the base R equivalents (e.g. <code>read.table</code>). These functions also directly output tibbles compatible with the tidyverse.</p>
<p>The <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-import.pdf">readr checksheet</a> provides a concise overview of the functionality in the package.</p>
<p>To illustrate how to use readr we will load a <code>.csv</code> file containing information about flights from 2014.</p>
<p>First we will download the data. You can download this data manually from <a href="https://github.com/arunsrinivasan/flights">github</a>. Instead we will use R to download the dataset using the <code>download.file()</code> base R function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='st'>"flights14.csv"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>url</span> <span class='op'>&lt;-</span> <span class='st'>"https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv"</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span><span class='op'>(</span><span class='va'>url</span>, <span class='st'>"flights14.csv"</span><span class='op'>)</span></span>
<span><span class='op'>}</span>  </span></code></pre>
</div>
</div>
<p>You should now have a file called “flights14.csv” in your working directory (the same directory as the Rmarkdown). To read this data into R, we can use the <code>read_csv()</code> function. The defaults for this function often work for many datasets.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>flights</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"flights14.csv"</span><span class='op'>)</span></span>
<span><span class='va'>flights</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 11
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     1     1        14        13 AA      JFK    LAX        359     2475
 2  2014     1     1        -3        13 AA      JFK    LAX        363     2475
 3  2014     1     1         2         9 AA      JFK    LAX        351     2475
 4  2014     1     1        -8       -26 AA      LGA    PBI        157     1035
 5  2014     1     1         2         1 AA      JFK    LAX        350     2475
 6  2014     1     1         4         0 AA      EWR    LAX        339     2454
 7  2014     1     1        -2       -18 AA      JFK    LAX        338     2475
 8  2014     1     1        -3       -14 AA      JFK    LAX        356     2475
 9  2014     1     1        -1       -17 AA      JFK    MIA        161     1089
10  2014     1     1        -2       -14 AA      JFK    SEA        349     2422
# ℹ 253,306 more rows
# ℹ 1 more variable: hour &lt;dbl&gt;</code></pre>
</div>
<p>There are a few commonly used arguments:
<code>col_names</code>: if the data doesn’t have column names, you can provide them (or skip them).</p>
<p><code>col_types</code>: set this if the data type of a column is incorrectly inferred by readr</p>
<p><code>comment</code>: if there are comment lines in the file, such as a header line prefixed with <code>#</code>, you want to skip, set this to <code>#</code>.</p>
<p><code>skip</code>: # of lines to skip before reading in the data.</p>
<p><code>n_max</code>: maximum number of lines to read, useful for testing reading in large datasets.</p>
<p>The readr functions will also automatically uncompress gzipped or zipped datasets, and additionally can read data directly from a URL.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv&quot;</span>)</span></code></pre></div>
<p>There are equivalent functions for writing data from R to files:
<code>write_csv</code>, <code>write_tsv</code>, <code>write_delim</code>.</p>
<h2 id="data-importexport-for-excel-files">Data import/export for excel files</h2>
<p>The <code>readxl</code> package can read data from excel files and is included in the tidyverse. The <code>read_excel()</code> function is the main function for reading data.</p>
<p>The <code>openxlsx</code> package, which is not part of tidyverse but is on <a href="https://ycphs.github.io/openxlsx/index.html">CRAN</a>, can write excel files. The <code>write.xlsx()</code> function is the main function for writing data to excel spreadsheets.</p>
<h2 id="data-importexport-of-r-objects">Data import/export of R objects</h2>
<p>Often it is useful to store R objects as files on disk. These could be large processed datasets, intermediate results, or complex data structures that are not easily stored in rectangular text formats.</p>
<p>R provides the <code>readRDS()</code> and <code>saveRDS()</code> functions for storing data in binary formats.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='st'>"flights.rds"</span><span class='op'>)</span> <span class='co'># save single object into a file</span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='st'>"flights.rds"</span><span class='op'>)</span> <span class='co'># read object back into R</span></span>
<span><span class='va'>df</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 11
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     1     1        14        13 AA      JFK    LAX        359     2475
 2  2014     1     1        -3        13 AA      JFK    LAX        363     2475
 3  2014     1     1         2         9 AA      JFK    LAX        351     2475
 4  2014     1     1        -8       -26 AA      LGA    PBI        157     1035
 5  2014     1     1         2         1 AA      JFK    LAX        350     2475
 6  2014     1     1         4         0 AA      EWR    LAX        339     2454
 7  2014     1     1        -2       -18 AA      JFK    LAX        338     2475
 8  2014     1     1        -3       -14 AA      JFK    LAX        356     2475
 9  2014     1     1        -1       -17 AA      JFK    MIA        161     1089
10  2014     1     1        -2       -14 AA      JFK    SEA        349     2422
# ℹ 253,306 more rows
# ℹ 1 more variable: hour &lt;dbl&gt;</code></pre>
</div>
<p>If you want to save/load multiple objects you can use <code>save()</code> and <code>load()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/save.html'>save</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>df</span>, file <span class='op'>=</span> <span class='st'>"robjs.rda"</span><span class='op'>)</span>  <span class='co'># save flight_df and df</span></span></code></pre>
</div>
</div>
<p><code>load()</code> will load the data into the environment with the same objects names used when saving the objects.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>df</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='st'>"robjs.rda"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="exploring-data">Exploring data</h2>
<p><code>View()</code> can be used to open an excel like view of a data.frame. This is a good way to quickly look at the data. <code>glimpse()</code> or <code>str()</code> give an additional view of the data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mtcars)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mtcars)</span></code></pre></div>
<p>Additional R functions to help with exploring data.frames (and tibbles):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span> <span class='co'># of rows and columns</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span> <span class='co'># first 6 lines</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span> <span class='co'># last 6 lines</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span> <span class='co'># column names</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span> <span class='co'># row names (not present in tibble)</span></span></code></pre>
</div>
</div>
<p>Useful base R functions for exploring values</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>$</span><span class='va'>gear</span><span class='op'>)</span> <span class='co'># get summary stats on column</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>$</span><span class='va'>cyl</span><span class='op'>)</span> <span class='co'># find unique values in column cyl</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>$</span><span class='va'>cyl</span><span class='op'>)</span> <span class='co'># get frequency of each value in column cyl</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>$</span><span class='va'>gear</span>, <span class='va'>mtcars</span><span class='op'>$</span><span class='va'>cyl</span><span class='op'>)</span> <span class='co'># get frequency of each combination of values</span></span></code></pre>
</div>
</div>
<h2 id="grammar-for-data-manipulation-dplyr">Grammar for data manipulation: dplyr</h2>
<h3 id="base-r-versus-dplyr">Base R versus dplyr</h3>
<p>In the first two lectures we introduced how to subset vectors, data.frames, and matrices
using base R functions. These approaches are flexible, succinct, and stable, meaning that
these approaches will likely be supported by R in the future.</p>
<p>Some criticisms of using base R are that the syntax is hard to read, it tends to be verbose, and difficult to learn. Dplyr, and other tidyverse packages, offer alternative approaches which many find easier to use. It is however necessary to know some base R in order to effectively use R.</p>
<p>Some key differences between base R and the approaches in dplyr (and tidyverse)</p>
<ul>
<li>Use of the tibble version of data.frame</li>
<li>dplyr functions operates on data.frame/tibbles rather than individual vectors</li>
<li>dplyr allows you to specifcy column names without quotes</li>
<li>dplyr uses different functions (verbs) to accomplish the different tasks performed by the bracket approach <code>[</code></li>
<li>dplyr and related functions recognized “grouped” operations on data.frames, enabling operations on different groups of rows in a data.frame</li>
</ul>
<h3 id="dplyr-function-overview">dplyr function overview</h3>
<p><code>dplyr</code> provides a suite of functions for manipulating data
in tibbles.</p>
<p>*Rows:<br />
- <code>filter()</code> chooses rows based on column values<br />
- <code>slice()</code> chooses rows based on location<br />
- <code>arrange()</code> changes the order of the rows<br />
- <code>distinct()</code> selects distinct/unique rows</p>
<p>*Columns:<br />
- <code>select()</code> changes whether or not a column is included<br />
- <code>rename()</code> changes the name of columns<br />
- <code>mutate()</code> changes the values of columns and creates new columns</p>
<p>Groups of rows:<br />
- <code>summarise()</code> collapses a group into a single row</p>
<h3 id="filter-rows">Filter rows</h3>
<p>Returning to our <code>flights</code> data. Let’s use <code>filter()</code> to select certain rows.</p>
<p><code>filter(tibble, conditional_expression, ...)</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>dest</span> <span class='op'>==</span> <span class='st'>"LAX"</span><span class='op'>)</span> <span class='co'>#select rows where the `dest` column is equal to `LAX</span></span></code></pre>
</div>
<pre><code># A tibble: 14,434 × 11
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     1     1        14        13 AA      JFK    LAX        359     2475
 2  2014     1     1        -3        13 AA      JFK    LAX        363     2475
 3  2014     1     1         2         9 AA      JFK    LAX        351     2475
 4  2014     1     1         2         1 AA      JFK    LAX        350     2475
 5  2014     1     1         4         0 AA      EWR    LAX        339     2454
 6  2014     1     1        -2       -18 AA      JFK    LAX        338     2475
 7  2014     1     1        -3       -14 AA      JFK    LAX        356     2475
 8  2014     1     1       142       133 AA      JFK    LAX        345     2475
 9  2014     1     1        -4        11 B6      JFK    LAX        349     2475
10  2014     1     1         3       -10 B6      JFK    LAX        349     2475
# ℹ 14,424 more rows
# ℹ 1 more variable: hour &lt;dbl&gt;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>arr_delay</span> <span class='op'>&gt;</span> <span class='fl'>200</span><span class='op'>)</span> <span class='co'># flights with arr_delay &gt; 200</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>distance</span> <span class='op'>&lt;</span> <span class='fl'>100</span><span class='op'>)</span> <span class='co'># flights less than 100 miles</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>year</span> <span class='op'>!=</span> <span class='fl'>2014</span><span class='op'>)</span> <span class='co'># if no rows satisfy condition, then an empty tibble</span></span></code></pre>
</div>
</div>
<p>Multiple conditions can be used to select rows. For example we can select rows where the <code>dest</code> column is equal to <code>LAX</code> and the <code>origin</code> is equal to <code>EWR</code>. You can either use the <code>&amp;</code> operator, or supply multiple arguments.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>dest</span> <span class='op'>==</span> <span class='st'>"LAX"</span>, <span class='va'>origin</span> <span class='op'>==</span> <span class='st'>"EWR"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>dest</span> <span class='op'>==</span> <span class='st'>"LAX"</span> <span class='op'>&amp;</span> <span class='va'>origin</span> <span class='op'>==</span> <span class='st'>"EWR"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We can select rows where the <code>dest</code> column is equal to <code>LAX</code> <strong>or</strong> the <code>origin</code> is equal to <code>EWR</code> using the <code>|</code> operator.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>dest</span> <span class='op'>==</span> <span class='st'>"LAX"</span> <span class='op'>|</span> <span class='va'>origin</span> <span class='op'>==</span> <span class='st'>"EWR"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The <code>%in%</code> operator is useful for identifying rows with entries matching those in a vector of possibilities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>dest</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LAX"</span>, <span class='st'>"SLC"</span>, <span class='st'>"SFO"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='op'>!</span><span class='va'>dest</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LAX"</span>, <span class='st'>"SLC"</span>, <span class='st'>"SFO"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># ! will negate</span></span></code></pre>
</div>
</div>
<p>Try it out:</p>
<ul>
<li>Use filter to find flights to DEN with a delayed departure (<code>dep_delay</code>).</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>dest</span> <span class='op'>==</span> <span class='st'>"DEN"</span>, <span class='va'>dep_delay</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 3,060 × 11
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     1     1        45        37 B6      JFK    DEN        237     1626
 2  2014     1     1         6       -13 DL      JFK    DEN        235     1626
 3  2014     1     1        13        16 DL      LGA    DEN        242     1620
 4  2014     1     1        35        47 F9      LGA    DEN        246     1620
 5  2014     1     1         2        19 WN      EWR    DEN        259     1605
 6  2014     1     1        17        60 WN      LGA    DEN        245     1620
 7  2014     1     1         3        12 WN      LGA    DEN        260     1620
 8  2014     1     1        10         3 UA      EWR    DEN        224     1605
 9  2014     1     1        46        43 UA      LGA    DEN        235     1620
10  2014     1     1        22         8 UA      EWR    DEN        237     1605
# ℹ 3,050 more rows
# ℹ 1 more variable: hour &lt;dbl&gt;</code></pre>
</div>
<h3 id="arrange-rows">arrange rows</h3>
<p><code>arrange()</code> can be used to sort the data based on values in a single or multiple columns</p>
<p><code>arrange(tibble, &lt;columns_to_sort_by&gt;)</code></p>
<p>For example, let’s find the flight with the shortest amount of air time by arranging the table based on the <code>air_time</code> (flight time in minutes).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>air_time</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 11
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     2    21        46        40 EV      EWR    BDL         20      116
 2  2014     6    20        -6        -2 US      LGA    BOS         20      184
 3  2014     1    16        -3       -12 EV      EWR    BDL         21      116
 4  2014     1    16        10        14 EV      EWR    BDL         21      116
 5  2014     2    19        19         0 EV      EWR    BDL         21      116
 6  2014     2    26        38        20 EV      EWR    BDL         21      116
 7  2014     3     4        17        -4 EV      EWR    BDL         21      116
 8  2014     6     5       105        93 EV      EWR    BDL         21      116
 9  2014     6     5        16         4 EV      EWR    BDL         21      116
10  2014     6    26        19        13 EV      EWR    BDL         21      116
# ℹ 253,306 more rows
# ℹ 1 more variable: hour &lt;dbl&gt;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>air_time</span>, <span class='va'>distance</span><span class='op'>)</span> <span class='co'># sort first on distance, then on air_time</span></span>
<span></span>
<span> <span class='co'># to sort in decreasing order, wrap the column name in `desc()`.</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>)</span>, <span class='va'>distance</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Try it out:</p>
<ul>
<li>Use arrange to rank the data by flight distance (<code>distance</code>), rank in ascending order. What flight has the shortest distance?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>distance</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code># A tibble: 1 × 11
   year month   day dep_delay arr_delay carrier origin dest  air_time distance
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1  2014     1    30         9        17 US      EWR    PHL         46       80
# ℹ 1 more variable: hour &lt;dbl&gt;</code></pre>
</div>
<h2 id="column-operations">Column operations</h2>
<h3 id="select-columns">select columns</h3>
<p><code>select()</code> is a simple function that subsets the tibble to keep certain columns.</p>
<p><code>select(tibble, &lt;columns_to_keep&gt;)</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>origin</span>, <span class='va'>dest</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 2
   origin dest 
   &lt;chr&gt;  &lt;chr&gt;
 1 JFK    LAX  
 2 JFK    LAX  
 3 JFK    LAX  
 4 LGA    PBI  
 5 JFK    LAX  
 6 EWR    LAX  
 7 JFK    LAX  
 8 JFK    LAX  
 9 JFK    MIA  
10 JFK    SEA  
# ℹ 253,306 more rows</code></pre>
</div>
<p>the <code>:</code> operator can select a range of columns, such as the columns from <code>air_time</code> to <code>hour</code>. The <code>!</code> operator selects columns not listed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>air_time</span><span class='op'>:</span><span class='va'>hour</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='op'>!</span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>:</span><span class='va'>hour</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>There is a suite of utilities in the tidyverse to help with select columns based on conditions: <code>matches()</code>, <code>starts_with()</code>, <code>ends_with()</code>, <code>contains()</code>, <code>any_of()</code>, and <code>all_of()</code>. <code>everything()</code> is also useful as a placeholder for all columns not explicitly listed. See help ?select</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># keep columns that have "delay" in the name</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"delay"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># select all columns except carrier</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='op'>-</span><span class='va'>carrier</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># reorder columns so that distance and hour are first columns</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"di"</span><span class='op'>)</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"ay"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="when-to-quote-or-not-quote">When to quote or not quote?</h2>
<p>In general, when working with the tidyverse, you don’t need to quote the names of columns. In the example above, we needed quotes because “delay” is not a column name in the flights tibble.</p>
<h2 id="adding-new-columns-with-mutate">Adding new columns with mutate</h2>
<p><code>mutate()</code> allows you to add new columns to the tibble.</p>
<p><code>mutate(tibble, new_column_name = expression, ...)</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>flights</span>, total_delay <span class='op'>=</span> <span class='va'>dep_delay</span> <span class='op'>+</span> <span class='va'>arr_delay</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 12
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     1     1        14        13 AA      JFK    LAX        359     2475
 2  2014     1     1        -3        13 AA      JFK    LAX        363     2475
 3  2014     1     1         2         9 AA      JFK    LAX        351     2475
 4  2014     1     1        -8       -26 AA      LGA    PBI        157     1035
 5  2014     1     1         2         1 AA      JFK    LAX        350     2475
 6  2014     1     1         4         0 AA      EWR    LAX        339     2454
 7  2014     1     1        -2       -18 AA      JFK    LAX        338     2475
 8  2014     1     1        -3       -14 AA      JFK    LAX        356     2475
 9  2014     1     1        -1       -17 AA      JFK    MIA        161     1089
10  2014     1     1        -2       -14 AA      JFK    SEA        349     2422
# ℹ 253,306 more rows
# ℹ 2 more variables: hour &lt;dbl&gt;, total_delay &lt;dbl&gt;</code></pre>
</div>
<p>We can’t see the new column, so we add a select command to examine the columns of interest.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>flights</span>, total_delay <span class='op'>=</span> <span class='va'>dep_delay</span> <span class='op'>+</span> <span class='va'>arr_delay</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>dep_delay</span>, <span class='va'>arr_delay</span>, <span class='va'>total_delay</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 3
   dep_delay arr_delay total_delay
       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1        14        13          27
 2        -3        13          10
 3         2         9          11
 4        -8       -26         -34
 5         2         1           3
 6         4         0           4
 7        -2       -18         -20
 8        -3       -14         -17
 9        -1       -17         -18
10        -2       -14         -16
# ℹ 253,306 more rows</code></pre>
</div>
<p>Multiple new columns can be made, and you can refer to columns made in preceding statements.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>flights</span>, </span>
<span>       total_delay <span class='op'>=</span> <span class='va'>dep_delay</span> <span class='op'>+</span> <span class='va'>arr_delay</span>,</span>
<span>       rank_delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rank.html'>rank</a></span><span class='op'>(</span><span class='va'>total_delay</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>total_delay</span>, <span class='va'>rank_delay</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Try it out:</p>
<ul>
<li>Calculate the flight time (<code>air_time</code>) in hours rather than in minutes, add as a new column.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>flights</span>, flight_time <span class='op'>=</span> <span class='va'>air_time</span> <span class='op'>/</span> <span class='fl'>60</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 12
    year month   day dep_delay arr_delay carrier origin dest  air_time distance
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2014     1     1        14        13 AA      JFK    LAX        359     2475
 2  2014     1     1        -3        13 AA      JFK    LAX        363     2475
 3  2014     1     1         2         9 AA      JFK    LAX        351     2475
 4  2014     1     1        -8       -26 AA      LGA    PBI        157     1035
 5  2014     1     1         2         1 AA      JFK    LAX        350     2475
 6  2014     1     1         4         0 AA      EWR    LAX        339     2454
 7  2014     1     1        -2       -18 AA      JFK    LAX        338     2475
 8  2014     1     1        -3       -14 AA      JFK    LAX        356     2475
 9  2014     1     1        -1       -17 AA      JFK    MIA        161     1089
10  2014     1     1        -2       -14 AA      JFK    SEA        349     2422
# ℹ 253,306 more rows
# ℹ 2 more variables: hour &lt;dbl&gt;, flight_time &lt;dbl&gt;</code></pre>
</div>
<h2 id="summarizing-columns">Summarizing columns</h2>
<p><code>summarize()</code> is a function that will collapse the data from a column into a summary value based on a function that takes a vector and returns a single value (e.g. mean(), sum(), median()). It is not very useful yet, but will be very powerful when we discuss grouped operations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span><span class='va'>flights</span>, </span>
<span>          avg_arr_delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>arr_delay</span><span class='op'>)</span>,</span>
<span>          med_air_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 1 × 2
  avg_arr_delay med_air_time
          &lt;dbl&gt;        &lt;dbl&gt;
1          8.15          134</code></pre>
</div>
<h2 id="grouped-operations">Grouped operations</h2>
<p>All of the functionality described above can be easily expressed in base R syntax (see examples <a href="https://dplyr.tidyverse.org/articles/base.html">here</a>). However, where dplyr really shines is the ability to apply the functions above to groups of data within each data frame.</p>
<p>We can establish groups within the data using <code>group_by()</code>. The functions <code>mutate()</code>, <code>summarize()</code>, and optionally <code>arrange()</code> will instead operate on each group independently rather than all of the rows.</p>
<p>Common approaches:
group_by -&gt; summarize: calculate summaries per group
group_by -&gt; mutate: calculate summaries per group and add as new column to original tibble</p>
<p><code>group_by(tibble, &lt;columns_to_establish_groups&gt;)</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>carrier</span><span class='op'>)</span> <span class='co'># notice the new "Groups:" metadata. </span></span>
<span></span>
<span><span class='co'># calculate average dep_delay per carrier</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>carrier</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>avg_dep_delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>dep_delay</span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># calculate average arr_delay per carrier at each airport</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>carrier</span>, <span class='va'>origin</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>avg_dep_delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>dep_delay</span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># calculate # of flights between each origin and destination city, per carrier, and average air time.</span></span>
<span> <span class='co'># n() is a special function that returns the # of rows per group</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>carrier</span>, <span class='va'>origin</span>, <span class='va'>dest</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>n_flights <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>            mean_air_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>)</span><span class='op'>)</span>  </span></code></pre>
</div>
</div>
<p>Here are some questions that we can answer using grouped operations in a few lines of dplyr code. Use pipes.</p>
<ul>
<li>What is the average flight <code>air_time</code> between each origin airport and destination airport?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>origin</span>, <span class='va'>dest</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>avg_air_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 221 × 3
# Groups:   origin [3]
   origin dest  avg_air_time
   &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;
 1 EWR    ALB           31.4
 2 EWR    ANC          424. 
 3 EWR    ATL          111. 
 4 EWR    AUS          210. 
 5 EWR    AVL           89.7
 6 EWR    AVP           25  
 7 EWR    BDL           25.4
 8 EWR    BNA          115. 
 9 EWR    BOS           40.1
10 EWR    BQN          197. 
# ℹ 211 more rows</code></pre>
</div>
<ul>
<li>What are the fastest and longest cities to fly between on average?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>origin</span>, <span class='va'>dest</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>avg_air_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>avg_air_time</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 1 × 3
# Groups:   origin [1]
  origin dest  avg_air_time
  &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;
1 EWR    AVP             25</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='va'>origin</span>, <span class='va'>dest</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>avg_air_time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>air_time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>avg_air_time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 1 × 3
# Groups:   origin [1]
  origin dest  avg_air_time
  &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;
1 JFK    HNL           625.</code></pre>
</div>
<p>Try it out:</p>
<ul>
<li>Which carrier has the fastest flight (<code>air_time</code>) on average from JFK to LAX?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<pre><code># A tibble: 5 × 2
  carrier flight_time
  &lt;chr&gt;         &lt;dbl&gt;
1 DL             328.
2 UA             328.
3 B6             328.
4 AA             330.
5 VX             333.</code></pre>
</div>
<ul>
<li>Which month has the longest departure delays on average when flying from JFK to HNL?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<pre><code># A tibble: 10 × 2
   month mean_dep_delay
   &lt;dbl&gt;          &lt;dbl&gt;
 1     2         52.9  
 2     1         41.2  
 3     7          2.48 
 4     9          1.04 
 5     8          1.03 
 6     3         -0.130
 7    10         -1.73 
 8     6         -1.76 
 9     5         -3.52 
10     4         -4.5  </code></pre>
</div>
<h2 id="string-manipulation">String manipulation</h2>
<p><code>stringr</code> is a package for working with strings (i.e. character vectors). It provides a consistent syntax for string manipulation and can perform many routine tasks:</p>
<p><code>str_c</code>: concatenate strings (similar to <code>paste()</code> in base R)<br />
<code>str_count</code>: count occurrence of a substring in a string<br />
<code>str_subset</code>: keep strings with a substring<br />
<code>str_replace</code>: replace a string with another string<br />
<code>str_split</code>: split a string into multiple pieces based on a string</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span></span>
<span><span class='va'>some_words</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a sentence"</span>, <span class='st'>"with a "</span>, <span class='st'>"needle in a"</span>, <span class='st'>"haystack"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>"needle"</span><span class='op'>)</span> <span class='co'># use with dplyr::filter</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>"needle"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>"needle"</span>, <span class='st'>"pumpkin"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>"a"</span>, <span class='st'>"A"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>some_words</span>, collapse <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>" words words words"</span>, <span class='st'>" anisfhlsdihg"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_count.html'>str_count</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>"a"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>some_words</span>, <span class='st'>" "</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>stringr uses <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions</a> to pattern match strings. This means that you can perform complex matching to the strings of interest. Additionally this means that there are special characters with behaviors that may be surprising if you are unaware of regular expressions.</p>
<p>A useful resource when using regular expressions is <a href="https://regex101.com" class="uri">https://regex101.com</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>complex_strings</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"10101-howdy"</span>, <span class='st'>"34-world"</span>, <span class='st'>"howdy-1010"</span>, <span class='st'>"world-."</span><span class='op'>)</span></span>
<span><span class='co'># keep words with a series of #s followed by a dash, + indicates one or more occurrences.</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>complex_strings</span>, <span class='st'>"[0-9]+-"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># keep words with a dash followed by a series of #s</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>complex_strings</span>, <span class='st'>"-[0-9]+"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>complex_strings</span>, <span class='st'>"^howdy"</span><span class='op'>)</span> <span class='co'># keep words starting with howdy</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>complex_strings</span>, <span class='st'>"howdy$"</span><span class='op'>)</span> <span class='co'># keep words ending with howdy</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>complex_strings</span>, <span class='st'>"."</span><span class='op'>)</span> <span class='co'># . signifies any character</span></span>
<span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='va'>complex_strings</span>, <span class='st'>"\\."</span><span class='op'>)</span> <span class='co'># need to use backticks to match literal special character</span></span></code></pre>
</div>
</div>
<p>Let’s use dplyr and stringr together.</p>
<p>Which destinations contain an “LL” in their 3 letter code?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>dest</span>, <span class='st'>"LL"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>dest</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 1 × 1
  dest 
  &lt;chr&gt;
1 FLL  </code></pre>
</div>
<p>Which 3-letter destination codes start with H?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flights</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>dest</span>, <span class='st'>"^H"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>dest</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 4 × 1
  dest 
  &lt;chr&gt;
1 HOU  
2 HNL  
3 HDN  
4 HYA  </code></pre>
</div>
<p>Let’s make a new column that combines the <code>origin</code> and <code>dest</code> columns.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>flights</span>, new_col <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>origin</span>, <span class='st'>":"</span>, <span class='va'>dest</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>new_col</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 253,316 × 12
   new_col  year month   day dep_delay arr_delay carrier origin dest  air_time
   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
 1 JFK:LAX  2014     1     1        14        13 AA      JFK    LAX        359
 2 JFK:LAX  2014     1     1        -3        13 AA      JFK    LAX        363
 3 JFK:LAX  2014     1     1         2         9 AA      JFK    LAX        351
 4 LGA:PBI  2014     1     1        -8       -26 AA      LGA    PBI        157
 5 JFK:LAX  2014     1     1         2         1 AA      JFK    LAX        350
 6 EWR:LAX  2014     1     1         4         0 AA      EWR    LAX        339
 7 JFK:LAX  2014     1     1        -2       -18 AA      JFK    LAX        338
 8 JFK:LAX  2014     1     1        -3       -14 AA      JFK    LAX        356
 9 JFK:MIA  2014     1     1        -1       -17 AA      JFK    MIA        161
10 JFK:SEA  2014     1     1        -2       -14 AA      JFK    SEA        349
# ℹ 253,306 more rows
# ℹ 2 more variables: distance &lt;dbl&gt;, hour &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>
Show session info
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/sessionInfo.html'>sessionInfo</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Monterey 12.2.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Denver
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] stringr_1.5.1 tibble_3.2.1  dplyr_1.1.3   readr_2.1.4  

loaded via a namespace (and not attached):
 [1] bit_4.0.5         jsonlite_1.8.7    compiler_4.3.1    crayon_1.5.2     
 [5] tidyselect_1.2.0  parallel_4.3.1    jquerylib_0.1.4   yaml_2.3.7       
 [9] fastmap_1.1.1     R6_2.5.1          generics_0.1.3    knitr_1.45       
[13] distill_1.6       bslib_0.5.1       pillar_1.9.0      tzdb_0.4.0       
[17] rlang_1.1.2       utf8_1.2.4        cachem_1.0.8      stringi_1.8.1    
[21] xfun_0.41         sass_0.4.7        bit64_4.0.5       memoise_2.0.1    
[25] cli_3.6.1         withr_2.5.2       magrittr_2.0.3    digest_0.6.33    
[29] vroom_1.6.4       rstudioapi_0.15.0 hms_1.1.3         lifecycle_1.0.4  
[33] vctrs_0.6.4       downlit_0.4.3     evaluate_0.23     glue_1.6.2       
[37] fansi_1.0.5       rmarkdown_2.25    tools_4.3.1       pkgconfig_2.0.3  
[41] htmltools_0.5.7  </code></pre>
</div>
</details>
<h2 class="appendix" id="acknowledgements-and-additional-references">Acknowledgements and additional references</h2>
<p>The content of this class borrows heavily from previous tutorials:</p>
<p>R code style guide:
<a href="http://adv-r.had.co.nz/Style.html" class="uri">http://adv-r.had.co.nz/Style.html</a></p>
<p>Tutorial organization:
<a href="https://github.com/sjaganna/molb7910-2019" class="uri">https://github.com/sjaganna/molb7910-2019</a></p>
<p>Other R tutorials:
<a href="https://github.com/matloff/fasteR" class="uri">https://github.com/matloff/fasteR</a>
<a href="https://r4ds.had.co.nz/index.html" class="uri">https://r4ds.had.co.nz/index.html</a>
<a href="https://bookdown.org/rdpeng/rprogdatascience/" class="uri">https://bookdown.org/rdpeng/rprogdatascience/</a></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
